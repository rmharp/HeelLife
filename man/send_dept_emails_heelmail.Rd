% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/scripting_functions.R
\name{send_dept_emails_heelmail}
\alias{send_dept_emails_heelmail}
\title{Send Emails to UNC Department Contacts via HeelMail}
\usage{
send_dept_emails_heelmail(
  contacts_df,
  username,
  password,
  subject,
  email_body,
  start_index = 1,
  test_email = NULL,
  cc_emails = NULL,
  high_importance = FALSE,
  attachment_paths = NULL,
  mfa_code = NULL
)
}
\arguments{
\item{contacts_df}{Data frame of department contacts (from get_unc_dept_contacts)}

\item{username}{Your UNC ONYEN username}

\item{password}{Your UNC password}

\item{subject}{Email subject line}

\item{email_body}{HTML content of the email body}

\item{start_index}{Index to start sending from (useful for resuming)}

\item{test_email}{Optional email address for testing (sends only to this address)}

\item{cc_emails}{Optional vector of email addresses to CC}

\item{high_importance}{Logical. Should emails be marked as high importance?}

\item{attachment_paths}{Optional vector of file paths to attach}

\item{mfa_code}{Optional MFA code to bypass interactive input (useful for testing)}
}
\value{
Invisible NULL. Function prints progress and results.
}
\description{
This function sends emails to Directors of Undergraduate Studies (DUS) and 
Student Services Managers (SSM) at UNC departments using the UNC HeelMail web interface.
}
\details{
The function uses RSelenium to automate the UNC HeelMail web interface. It requires
your UNC credentials and handles MFA authentication. This provides an alternative to
Gmail API for users who prefer to use UNC's official email system.
}
\examples{
\dontrun{
# First, scrape contacts
contacts <- get_unc_dept_contacts()

# Send emails via HeelMail
send_dept_emails_heelmail(
  contacts_df = contacts,
  username = "your_onyen",
  password = "your_password",
  subject = "Important Announcement",
  email_body = "<p>Hello,</p><p>This is a test email.</p>"
)

# Test with a single email first
send_dept_emails_heelmail(
  contacts_df = contacts,
  username = "your_onyen",
  password = "your_password",
  subject = "Test Email",
  email_body = "<p>Test email body</p>",
  test_email = "test@example.com"
)
}
}
